import{q as ee,W as K,r as c,j as e,Y as se,a as $,d as ae}from"./app-D3xhd7x4.js";import{T as ne,a as te}from"./toaster-FnjXybNn.js";import{I as o}from"./InputError-DKuUmmK1.js";import{B as v}from"./button-kSVH6inc.js";import{C as w,a as S,b as k,d as M}from"./card-XJZW572Q.js";import{I as p}from"./input-B5jvm_hA.js";import{L as t}from"./label-B7b8UO_Y.js";import{S as f,a as b,b as y,c as N,d as l}from"./select-U6-rirhH.js";import{S as le}from"./SingleImageUploader-wXoJOceP.js";import{t as E}from"./use-toast-CeK-EtdP.js";import{D as B,a as Q,b as H,c as X,d as Z,e as re}from"./dialog-CoUukDiU.js";import"./index-BkFfMWl8.js";import"./index-CHWu3Xan.js";import"./index-DjfCHU90.js";import"./x-n02M-ldN.js";import"./createLucideIcon-RljSjpz3.js";import"./index-Bb4qSo10.js";import"./utils-C-Zvzyq5.js";import"./index-BN1U6-Hz.js";import"./index-CQ59I0Dq.js";import"./index-D_4hUVl6.js";import"./check-CcE03I2l.js";import"./index-BA9ojx9c.js";const ie=()=>{var m;const i=ee().props.packages,{data:a,setData:r,errors:n,post:_,processing:u,clearErrors:j}=K({name:"",phone:"",occupation:"",gender:"",marital_status:"",date_of_birth:new Date(new Date().setFullYear(new Date().getFullYear()-20)).toISOString().split("T")[0],address:"",preferred_time:"",payment_proof:"",membership_package_id:i[0].id,months:1,photo:null,emergency_person_name:"",emergency_person_phone:""}),[C,g]=c.useState(0),[P,h]=c.useState(0),[T,V]=c.useState(0),[O,I]=c.useState(0),[q,L]=c.useState(0),[G,U]=c.useState(0),Y=new URLSearchParams(window.location.search),[J,R]=c.useState(Y.get("form")==="register"),W=()=>{const s=i.find(d=>d.id===a.membership_package_id);if(s){const d=Number(s.admission_amount)||0,x=Number(s.monthly_amount)||0,F=x*a.months,A=d+F;let D=0;a.months===3?D=Number(s.discount_quarterly)||0:a.months===6?D=Number(s.discount_half_yearly)||0:a.months===12&&(D=Number(s.discount_yearly)||0),g(d),h(x),V(F),I(A),L(D),U(A-D)}};c.useEffect(()=>{W()},[a.membership_package_id,a.months]);const z=s=>{s.preventDefault(),j(),_("/member/store/apply",{onSuccess:()=>{R(!1),E({description:"Membership registration application submitted, pending admin approval...",duration:5e3})}})};return e.jsxs(B,{open:J,onOpenChange:R,children:[e.jsxs(Q,{children:[e.jsx(v,{className:"hidden md:block w-full",color:"primary",type:"submit",disabled:u,children:"Register Membership"}),e.jsx(v,{className:"w-full md:hidden",size:"sm",color:"primary",type:"submit",disabled:u,children:"Register Membership"})]}),e.jsxs(H,{className:"max-w-7xl w-[97%] max-h-[97vh] overflow-auto rounded",children:[e.jsx(X,{children:e.jsx(Z,{children:"Register a Membership"})}),e.jsx("div",{className:"w-full mx-auto space-y-6",children:e.jsx("form",{onSubmit:z,children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsxs("div",{className:"lg:col-span-6 xl:col-span-7 2xl:col-span-8 space-y-6",children:[e.jsxs(w,{children:[e.jsx(S,{children:e.jsx(k,{className:"text-lg",children:"Member Information"})}),e.jsxs(M,{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("div",{className:"w-32",children:[e.jsx(le,{onImageUpload:s=>r("photo",s),className:"aspect-square px-2 w-full",label:"Upload Member Photo"}),e.jsx(o,{message:n.photo,className:"mt-2"})]}),e.jsxs("div",{className:"grow",children:[e.jsx(t,{htmlFor:"name",children:"Name"}),e.jsx(p,{id:"name",value:a.name,onChange:s=>{const d=s.target.value.toLowerCase().replace(/\b\w/g,x=>x.toUpperCase());r("name",d)},placeholder:"Enter member's name",required:!0}),e.jsx(o,{message:n.name,className:"mt-2"}),e.jsx(t,{htmlFor:"address",children:"Address"}),e.jsx(p,{id:"address",value:a.address,onChange:s=>r("address",s.target.value),placeholder:"Enter address",required:!0}),e.jsx(o,{message:n.address,className:"mt-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"phone",children:"Phone"}),e.jsx(p,{id:"phone",value:a.phone,onChange:s=>r("phone",s.target.value),placeholder:"Enter phone number",required:!0,maxLength:10,minLength:10}),e.jsx(o,{message:n.phone,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"occupation",children:"Occupation"}),e.jsxs(f,{defaultValue:a.occupation,onValueChange:s=>r("occupation",s),children:[e.jsx(b,{id:"occupation",children:e.jsx(y,{placeholder:"Select occupation"})}),e.jsxs(N,{children:[e.jsx(l,{value:"private-job",children:"Private Job"}),e.jsx(l,{value:"government-job",children:"Government Job"}),e.jsx(l,{value:"business",children:"Business"}),e.jsx(l,{value:"student",children:"Student"}),e.jsx(l,{value:"housewife",children:"House Wife"}),e.jsx(l,{value:"other",children:"Other"})]})]}),e.jsx(o,{message:n.occupation,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Gender"}),e.jsxs(f,{defaultValue:a.gender,onValueChange:s=>r("gender",s),children:[e.jsx(b,{id:"gender",children:e.jsx(y,{placeholder:"Select gender"})}),e.jsxs(N,{children:[e.jsx(l,{value:"male",children:"Male"}),e.jsx(l,{value:"female",children:"Female"})]})]}),e.jsx(o,{message:n.gender,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Marital Status"}),e.jsxs(f,{defaultValue:a.marital_status,onValueChange:s=>r("marital_status",s),children:[e.jsx(b,{id:"marital_status",children:e.jsx(y,{placeholder:"Select marital status"})}),e.jsxs(N,{children:[e.jsx(l,{value:"single",children:"Single"}),e.jsx(l,{value:"married",children:"Married"})]})]}),e.jsx(o,{message:n.marital_status,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"date_of_birth",children:"Date of Birth"}),e.jsx(p,{id:"date_of_birth",type:"date",value:a.date_of_birth,onChange:s=>r("date_of_birth",s.target.value),required:!0}),e.jsx(o,{message:n.date_of_birth,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"preferred_time",children:"Preferred Shift"}),e.jsxs(f,{onValueChange:s=>r("preferred_time",s),children:[e.jsx(b,{children:e.jsx(y,{placeholder:"Select preferred shift"})}),e.jsxs(N,{children:[e.jsx(l,{value:"Morning",children:"Morning"}),e.jsx(l,{value:"Day",children:"Day"}),e.jsx(l,{value:"Evening",children:"Evening"})]})]}),e.jsx(o,{message:n.preferred_time,className:"mt-2"})]})]})]})]}),e.jsxs(w,{children:[e.jsx(S,{children:e.jsx(k,{className:"text-lg",children:"Membership and Payment Details"})}),e.jsxs(M,{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(t,{htmlFor:"membership_package",children:"Membership Package"}),e.jsxs(f,{defaultValue:a.membership_package_id.toString(),onValueChange:s=>r("membership_package_id",Number(s)),children:[e.jsx(b,{id:"membership_package",children:e.jsx(y,{placeholder:"Select membership package"})}),e.jsx(N,{children:i.map(s=>e.jsx(l,{value:s.id.toString(),children:s.package_name},s.id))})]}),e.jsx(o,{message:n.membership_package_id,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"grow",children:[e.jsx(t,{htmlFor:"months",children:"Initial Registration Months"}),e.jsxs(f,{defaultValue:a.months.toString(),onValueChange:s=>r("months",Number(s)),children:[e.jsx(b,{id:"months",children:e.jsx(y,{placeholder:"Select membership months"})}),e.jsxs(N,{children:[e.jsx(l,{value:"1",children:"1 Month"}),e.jsx(l,{value:"3",children:"3 Months"}),e.jsx(l,{value:"6",children:"6 Months"}),e.jsx(l,{value:"12",children:"1 Year"})]})]}),e.jsx(o,{message:n.months,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(t,{htmlFor:"payment_proof",children:"Payment Proof"}),e.jsx(p,{type:"file",accept:"image/*",onChange:s=>{r("payment_proof",s.target.files?s.target.files[0]:"")}}),e.jsx(o,{message:n.payment_proof})]})]})]})]})]}),e.jsxs("div",{className:"lg:col-span-6 xl:col-span-5 2xl:col-span-4 space-y-6",children:[e.jsxs(w,{children:[e.jsx(S,{children:e.jsx(k,{className:"text-lg",children:"Emergency Information"})}),e.jsxs(M,{className:"gap-2 flex flex-col flex-wrap",children:[e.jsxs("div",{className:"grow",children:[e.jsx(t,{htmlFor:"emergency_person_name",children:"Person Name"}),e.jsx(p,{id:"emergency_person_name",value:a.emergency_person_name,onChange:s=>{const d=s.target.value.toLowerCase().replace(/\b\w/g,x=>x.toUpperCase());r("emergency_person_name",d)},placeholder:"Enter emergency contact person name"}),e.jsx(o,{message:n.emergency_person_name,className:"mt-2"})]}),e.jsxs("div",{className:"grow",children:[e.jsx(t,{htmlFor:"emergency_person_phone",children:"Phone"}),e.jsx(p,{id:"emergency_person_phone",value:a.emergency_person_phone,onChange:s=>r("emergency_person_phone",s.target.value),placeholder:"Enter emergency contact phone number"}),e.jsx(o,{message:n.emergency_person_phone,className:"mt-2"})]})]})]}),e.jsxs(w,{children:[e.jsx(S,{children:e.jsx(k,{className:"text-lg",children:"Pricing and Payment"})}),e.jsxs(M,{children:[e.jsx("div",{className:"text-start mb-3",children:e.jsx("strong",{children:(m=i.find(s=>s.id===a.membership_package_id))==null?void 0:m.package_name})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(t,{children:"Admission Amount"}),e.jsxs("span",{children:["Rs ",C]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(t,{children:"Monthly Amount"}),e.jsxs("span",{children:["Rs ",P]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(t,{children:"Total Months"}),e.jsxs("span",{children:[a.months," Months"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(t,{children:"Total Monthly Fees"}),e.jsxs("span",{children:["Rs ",T]})]}),e.jsx("div",{className:"border mb-2"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(t,{children:"Gross Package Amount"}),e.jsxs("span",{children:["Rs ",O]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(t,{children:"Package Discount"}),e.jsxs("span",{children:["- Rs ",q]})]}),e.jsx("div",{className:"border mb-2"}),e.jsxs("strong",{className:"flex justify-between",children:[e.jsx(t,{children:"Net Amount"}),e.jsxs("span",{children:["Rs ",G]})]}),e.jsx(v,{type:"submit",disabled:u,className:"w-full mt-3",children:u?"Processing...":"Apply for registration"})]})]})]})]})})})]})]})},ce=ie,oe=({member:i,open:a,onClose:r})=>{const{data:n,setData:_,reset:u,errors:j,post:C,processing:g,clearErrors:P}=K({selected_months:1,payment_proof:null}),[h,T]=c.useState(0),[V,O]=c.useState(0),[I,q]=c.useState(0),[L,G]=c.useState(0),[U,Y]=c.useState(0),[J,R]=c.useState(""),W=m=>{const s=new Date(i.payment_expiry_date);return new Date(s.setMonth(s.getMonth()+m)).toISOString().split("T")[0]};c.useEffect(()=>{const m=Number(i.membership_package.monthly_amount)||0,s=m*n.selected_months;let d=0;n.selected_months===3?d=Number(i.membership_package.discount_quarterly)||0:n.selected_months===6?d=Number(i.membership_package.discount_half_yearly)||0:n.selected_months===12&&(d=Number(i.membership_package.discount_yearly)||0);const x=s,F=x-d;T(m),O(s),q(x),G(d),Y(Math.max(F,0));const A=W(n.selected_months);R(A)},[n.selected_months]);const z=m=>{m.preventDefault(),P(),C(route("renewal.public.store",i.id),{onSuccess:()=>{E({description:"Membership renewal submitted, pending admin approval..."}),r(),u()}})};return e.jsx(B,{open:a,onOpenChange:r,children:e.jsxs(H,{className:"max-w-4xl w-[95vw] mx-auto rounded-lg p-6 shadow-lg overflow-auto max-h-[95vh]",children:[e.jsxs(X,{children:[e.jsx(Z,{className:"text-xl font-semibold",children:"Membership Renewal"}),e.jsxs(re,{className:"text-sm",children:["Renew membership package of ",e.jsx("strong",{children:i.name}),"."]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-4",children:[e.jsxs(w,{children:[e.jsx(S,{children:e.jsx(k,{className:"text-lg font-semibold",children:"Renewal Summary"})}),e.jsxs(M,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Current Expiry Date"}),e.jsx("strong",{children:i.payment_expiry_date})]}),e.jsx("hr",{className:"my-2"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Monthly Fees"}),e.jsxs("span",{children:["Rs ",h]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Monthly Fees"}),e.jsxs("span",{children:["Rs ",V]})]}),e.jsx("div",{className:"border-t my-2"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Gross Amount"}),e.jsxs("span",{children:["Rs ",I]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Discount"}),e.jsxs("span",{children:["- Rs ",L]})]}),e.jsx("div",{className:"border-t my-2"}),e.jsxs("div",{className:"flex justify-between font-bold",children:[e.jsx("span",{children:"Net Amount"}),e.jsxs("span",{children:["Rs ",U]})]})]})]}),e.jsxs(w,{children:[e.jsx(S,{className:"pb-0"}),e.jsxs(M,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2 bg-muted p-3 rounded-lg",children:[e.jsx("div",{className:"",children:e.jsx("img",{className:"size-[40px] rounded-full object-cover",src:i.photo,alt:i.name})}),e.jsxs("div",{className:"grow flex flex-col",children:[e.jsx("span",{className:"font-semibold font-lg",children:i.name}),e.jsx("small",{className:"font-xs",children:i.phone})]})]}),e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(t,{children:"Renewal Period (in months)"}),e.jsxs(f,{value:n.selected_months.toString(),onValueChange:m=>_("selected_months",Number(m)),children:[e.jsx(b,{id:"months",children:e.jsx(y,{placeholder:"Select duration"})}),e.jsxs(N,{children:[e.jsx(l,{value:"1",children:"1 Month"}),e.jsx(l,{value:"3",children:"3 Months"}),e.jsx(l,{value:"6",children:"6 Months"}),e.jsx(l,{value:"12",children:"1 Year"})]})]}),e.jsx(o,{message:j.selected_months})]}),e.jsxs("div",{children:[e.jsx(t,{children:"Payment Proof (Optional)"}),e.jsx(p,{type:"file",onChange:m=>_("payment_proof",m.target.files?m.target.files[0]:null)}),e.jsx(o,{message:j.payment_proof})]}),e.jsx(v,{type:"submit",disabled:g,children:g?"Processing...":"Confirm Renewal"})]})]})]})]})]})})},de=oe;function Ee(){const[i,a]=c.useState(""),[r,n]=c.useState(null),_=new URLSearchParams(window.location.search),[u,j]=c.useState(!1),[C,g]=c.useState(_.get("form")==="renew"),P=async()=>{try{const h=await ae.get(`/get-renewal-form/${i}`);h.data.member?(n(h.data.member),g(!1),j(!0)):E({description:"Member not found or no active membership"})}catch{E({description:"Error fetching member data"})}};return e.jsxs(ne,{attribute:"class",defaultTheme:"dark",enableSystem:!0,disableTransitionOnChange:!0,children:[e.jsxs("div",{className:"w-full h-screen bg-no-repeat bg-cover relative",style:{backgroundImage:"url('gym-bg.jpg')"},children:[e.jsx(se,{title:"Welcome to Chitwangym"}),e.jsx("div",{className:"absolute w-full min-h-full bg-black/60 text-white"}),e.jsxs("div",{className:"relative container min-h-full flex flex-col",children:[e.jsxs("div",{className:"py-7 flex justify-between items-center",children:[e.jsx($,{href:"/",className:"flex items-center py-3 px-5 w-fit",children:e.jsx("span",{className:"text-xl sm:text-2xl text-white font-semibold",children:"Nexis Fitness"})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx($,{href:"/login",className:"text-sm text-gray-200 hover:underline",children:"Go to Admin Area"})})]}),e.jsx("div",{className:"grow flex items-center justify-center",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl lg:text-4xl xl:text-5xl text-center text-white font-extrabold uppercase",children:"Welcome to Nexis Fitness"}),e.jsx("h3",{className:"text-white/75 text-center capitalize md:text-lg lg:text-xl font-semibold",children:"Your Fitness Journey Starts Here. Let's Achieve Your Goals Together."}),e.jsxs("div",{className:"flex gap-2 mx-auto justify-center",children:[e.jsx(ce,{})," ",e.jsxs(B,{open:C,onOpenChange:g,children:[e.jsxs(Q,{children:[e.jsx(v,{className:"md:hidden",size:"sm",children:"Renew Membership"}),e.jsx(v,{className:"hidden md:block",children:"Renew Membership"})]}),e.jsxs(H,{className:"space-y-1",children:[e.jsx("h2",{className:"font-bold",children:"Enter Phone Number to Renew"}),e.jsx(p,{type:"number",className:"flex-grow",onChange:h=>a(h.target.value),placeholder:"Phone number"}),e.jsx("div",{className:"text-end",children:e.jsx(v,{className:"me-auto",onClick:P,children:"Submit Renewal Request"})})]})]})]})]})})]})]}),e.jsx(te,{}),r&&e.jsx(de,{member:r,open:u,onClose:()=>j(!1)})]})}export{Ee as default};
