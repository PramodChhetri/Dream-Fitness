import{q as ee,W as K,r as c,j as e,Y as se,a as $,d as ae}from"./app-3SIRTf-5.js";import{T as te,a as ne}from"./toaster-Dw7QYiKI.js";import{I as o}from"./InputError-BCZ6gpxT.js";import{B as g}from"./button-mE5Zer4v.js";import{C as _,a as w,b as D,d as S}from"./card-CBtJbqk1.js";import{I as h}from"./input-B_VqwVNS.js";import{L as n}from"./label-sM4Vfyun.js";import{S as b,a as y,b as N,c as v,d as i}from"./select-BAAnM0MM.js";import{S as le}from"./SingleImageUploader-BKnIjpuV.js";import{t as E}from"./use-toast-D1Qu1tBf.js";import{D as B,a as Q,b as H,c as X,d as Z,e as re}from"./dialog-HXmWLQJG.js";import"./index-YuXTghCy.js";import"./index-Cqu9cwS9.js";import"./index-BwJKMgpa.js";import"./x-ZThs6_Gk.js";import"./createLucideIcon-a0XJ54KJ.js";import"./index-Bb4qSo10.js";import"./utils-C-Zvzyq5.js";import"./index-C3fbTtBW.js";import"./index-v8WOfFnQ.js";import"./index-BVcS-tUL.js";import"./index-SipnJt1m.js";const ie=()=>{var d;const r=ee().props.packages,{data:a,setData:l,errors:t,post:f,processing:p,clearErrors:u}=K({name:"",phone:"",occupation:"",gender:"",marital_status:"",date_of_birth:new Date(new Date().setFullYear(new Date().getFullYear()-20)).toISOString().split("T")[0],address:"",preferred_time:"",payment_proof:"",membership_package_id:r[0].id,months:1,photo:null,emergency_person_name:"",emergency_person_phone:""}),[M,j]=c.useState(0),[k,x]=c.useState(0),[T,O]=c.useState(0),[I,V]=c.useState(0),[q,G]=c.useState(0),[L,Y]=c.useState(0),U=new URLSearchParams(window.location.search),[J,R]=c.useState(U.get("form")==="register"),W=()=>{const s=r.find(m=>m.id===a.membership_package_id);if(s){const m=Number(s.admission_amount)||0,P=Number(s.monthly_amount)||0,A=P*a.months,F=m+A;let C=0;a.months===3?C=Number(s.discount_quarterly)||0:a.months===6?C=Number(s.discount_half_yearly)||0:a.months===12&&(C=Number(s.discount_yearly)||0),j(m),x(P),O(A),V(F),G(C),Y(F-C)}};c.useEffect(()=>{W()},[a.membership_package_id,a.months]);const z=s=>{s.preventDefault(),u(),f("/member/store/apply",{onSuccess:()=>{R(!1),E({description:"Membership registration application submitted, pending admin approval...",duration:5e3})}})};return e.jsxs(B,{open:J,onOpenChange:R,children:[e.jsxs(Q,{children:[e.jsx(g,{className:"hidden md:block w-full",color:"primary",type:"submit",disabled:p,children:"Register Membership"}),e.jsx(g,{className:"w-full md:hidden",size:"sm",color:"primary",type:"submit",disabled:p,children:"Register Membership"})]}),e.jsxs(H,{className:"max-w-7xl w-[97%] max-h-[97vh] overflow-auto rounded",children:[e.jsx(X,{children:e.jsx(Z,{children:"Register a Membership"})}),e.jsx("div",{className:"w-full mx-auto space-y-6",children:e.jsx("form",{onSubmit:z,children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsxs("div",{className:"lg:col-span-6 xl:col-span-7 2xl:col-span-8 space-y-6",children:[e.jsxs(_,{children:[e.jsx(w,{children:e.jsx(D,{className:"text-lg",children:"Member Information"})}),e.jsxs(S,{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("div",{className:"w-32",children:[e.jsx(le,{onImageUpload:s=>l("photo",s),className:"aspect-square px-2 w-full",label:"Upload Member Photo"}),e.jsx(o,{message:t.photo,className:"mt-2"})]}),e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"name",children:"Name"}),e.jsx(h,{id:"name",value:a.name,onChange:s=>l("name",s.target.value),placeholder:"Enter member's name",required:!0}),e.jsx(o,{message:t.name,className:"mt-2"}),e.jsx(n,{htmlFor:"address",children:"Address"}),e.jsx(h,{id:"address",value:a.address,onChange:s=>l("address",s.target.value),placeholder:"Enter address",required:!0}),e.jsx(o,{message:t.address,className:"mt-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"phone",children:"Phone"}),e.jsx(h,{id:"phone",value:a.phone,onChange:s=>l("phone",s.target.value),placeholder:"Enter phone number",required:!0,maxLength:10,minLength:10}),e.jsx(o,{message:t.phone,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"occupation",children:"Occupation"}),e.jsxs(b,{defaultValue:a.occupation,onValueChange:s=>l("occupation",s),children:[e.jsx(y,{id:"occupation",children:e.jsx(N,{placeholder:"Select occupation"})}),e.jsxs(v,{children:[e.jsx(i,{value:"private-job",children:"Private Job"}),e.jsx(i,{value:"government-job",children:"Government Job"}),e.jsx(i,{value:"business",children:"Business"}),e.jsx(i,{value:"student",children:"Student"}),e.jsx(i,{value:"housewife",children:"House Wife"}),e.jsx(i,{value:"other",children:"Other"})]})]}),e.jsx(o,{message:t.occupation,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Gender"}),e.jsxs(b,{defaultValue:a.gender,onValueChange:s=>l("gender",s),children:[e.jsx(y,{id:"gender",children:e.jsx(N,{placeholder:"Select gender"})}),e.jsxs(v,{children:[e.jsx(i,{value:"male",children:"Male"}),e.jsx(i,{value:"female",children:"Female"})]})]}),e.jsx(o,{message:t.gender,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Marital Status"}),e.jsxs(b,{defaultValue:a.marital_status,onValueChange:s=>l("marital_status",s),children:[e.jsx(y,{id:"marital_status",children:e.jsx(N,{placeholder:"Select marital status"})}),e.jsxs(v,{children:[e.jsx(i,{value:"single",children:"Single"}),e.jsx(i,{value:"married",children:"Married"})]})]}),e.jsx(o,{message:t.marital_status,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"date_of_birth",children:"Date of Birth"}),e.jsx(h,{id:"date_of_birth",type:"date",value:a.date_of_birth,onChange:s=>l("date_of_birth",s.target.value),required:!0}),e.jsx(o,{message:t.date_of_birth,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"preferred_time",children:"Preferred Time"}),e.jsx(h,{id:"preferred_time",type:"time",value:a.preferred_time,onChange:s=>l("preferred_time",s.target.value),required:!0}),e.jsx(o,{message:t.preferred_time,className:"mt-2"})]})]})]})]}),e.jsxs(_,{children:[e.jsx(w,{children:e.jsx(D,{className:"text-lg",children:"Membership and Payment Details"})}),e.jsxs(S,{className:"space-y-2",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"membership_package",children:"Membership Package"}),e.jsxs(b,{defaultValue:a.membership_package_id.toString(),onValueChange:s=>l("membership_package_id",Number(s)),children:[e.jsx(y,{id:"membership_package",children:e.jsx(N,{placeholder:"Select membership package"})}),e.jsx(v,{children:r.map(s=>e.jsx(i,{value:s.id.toString(),children:s.package_name},s.id))})]}),e.jsx(o,{message:t.membership_package_id,className:"mt-2"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"months",children:"Initial Registration Months"}),e.jsxs(b,{defaultValue:a.months.toString(),onValueChange:s=>l("months",Number(s)),children:[e.jsx(y,{id:"months",children:e.jsx(N,{placeholder:"Select membership months"})}),e.jsxs(v,{children:[e.jsx(i,{value:"1",children:"1 Month"}),e.jsx(i,{value:"3",children:"3 Months"}),e.jsx(i,{value:"6",children:"6 Months"}),e.jsx(i,{value:"12",children:"1 Year"})]})]}),e.jsx(o,{message:t.months,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"payment_proof",children:"Payment Proof"}),e.jsx(h,{type:"file",accept:"image/*",onChange:s=>{l("payment_proof",s.target.files?s.target.files[0]:"")}}),e.jsx(o,{message:t.payment_proof})]})]})]})]})]}),e.jsxs("div",{className:"lg:col-span-6 xl:col-span-5 2xl:col-span-4 space-y-6",children:[e.jsxs(_,{children:[e.jsx(w,{children:e.jsx(D,{className:"text-lg",children:"Emergency Information"})}),e.jsxs(S,{className:"gap-2 flex flex-col flex-wrap",children:[e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"emergency_person_name",children:"Person Name"}),e.jsx(h,{id:"emergency_person_name",value:a.emergency_person_name,onChange:s=>l("emergency_person_name",s.target.value),placeholder:"Enter emergency contact person name"}),e.jsx(o,{message:t.emergency_person_name,className:"mt-2"})]}),e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"emergency_person_phone",children:"Phone"}),e.jsx(h,{id:"emergency_person_phone",value:a.emergency_person_phone,onChange:s=>l("emergency_person_phone",s.target.value),placeholder:"Enter emergency contact phone number"}),e.jsx(o,{message:t.emergency_person_phone,className:"mt-2"})]})]})]}),e.jsxs(_,{children:[e.jsx(w,{children:e.jsx(D,{className:"text-lg",children:"Pricing and Payment"})}),e.jsxs(S,{children:[e.jsx("div",{className:"text-start mb-3",children:e.jsx("strong",{children:(d=r.find(s=>s.id===a.membership_package_id))==null?void 0:d.package_name})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Admission Amount"}),e.jsxs("span",{children:["Rs ",M]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Monthly Amount"}),e.jsxs("span",{children:["Rs ",k]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Total Months"}),e.jsxs("span",{children:[a.months," Months"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Total Monthly Fees"}),e.jsxs("span",{children:["Rs ",T]})]}),e.jsx("div",{className:"border mb-2"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Gross Package Amount"}),e.jsxs("span",{children:["Rs ",I]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Package Discount"}),e.jsxs("span",{children:["- Rs ",q]})]}),e.jsx("div",{className:"border mb-2"}),e.jsxs("strong",{className:"flex justify-between",children:[e.jsx(n,{children:"Net Amount"}),e.jsxs("span",{children:["Rs ",L]})]}),e.jsx(g,{type:"submit",disabled:p,className:"w-full mt-3",children:p?"Processing...":"Apply for registration"})]})]})]})]})})})]})]})},ce=ie,oe=({member:r,open:a,onClose:l})=>{const{data:t,setData:f,reset:p,errors:u,post:M,processing:j,clearErrors:k}=K({selected_months:1,payment_proof:null}),[x,T]=c.useState(0),[O,I]=c.useState(0),[V,q]=c.useState(0),[G,L]=c.useState(0),[Y,U]=c.useState(0),[J,R]=c.useState(""),W=d=>{const s=new Date(r.payment_expiry_date);return new Date(s.setMonth(s.getMonth()+d)).toISOString().split("T")[0]};c.useEffect(()=>{const d=Number(r.membership_package.monthly_amount)||0,s=d*t.selected_months;let m=0;t.selected_months===3?m=Number(r.membership_package.discount_quarterly)||0:t.selected_months===6?m=Number(r.membership_package.discount_half_yearly)||0:t.selected_months===12&&(m=Number(r.membership_package.discount_yearly)||0);const P=s,A=P-m;T(d),I(s),q(P),L(m),U(Math.max(A,0));const F=W(t.selected_months);R(F)},[t.selected_months]);const z=d=>{d.preventDefault(),k(),M(route("renewal.public.store",r.id),{onSuccess:()=>{E({description:"Membership renewal submitted, pending admin approval..."}),l(),p()}})};return e.jsx(B,{open:a,onOpenChange:l,children:e.jsxs(H,{className:"max-w-4xl w-[95vw] mx-auto rounded-lg p-6 shadow-lg overflow-auto max-h-[95vh]",children:[e.jsxs(X,{children:[e.jsx(Z,{className:"text-xl font-semibold",children:"Membership Renewal"}),e.jsxs(re,{className:"text-sm",children:["Renew membership package of ",e.jsx("strong",{children:r.name}),"."]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-4",children:[e.jsxs(_,{children:[e.jsx(w,{children:e.jsx(D,{className:"text-lg font-semibold",children:"Renewal Summary"})}),e.jsxs(S,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Current Expiry Date"}),e.jsx("strong",{children:r.payment_expiry_date})]}),e.jsx("hr",{className:"my-2"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Monthly Fees"}),e.jsxs("span",{children:["Rs ",x]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total Monthly Fees"}),e.jsxs("span",{children:["Rs ",O]})]}),e.jsx("div",{className:"border-t my-2"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Gross Amount"}),e.jsxs("span",{children:["Rs ",V]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Discount"}),e.jsxs("span",{children:["- Rs ",G]})]}),e.jsx("div",{className:"border-t my-2"}),e.jsxs("div",{className:"flex justify-between font-bold",children:[e.jsx("span",{children:"Net Amount"}),e.jsxs("span",{children:["Rs ",Y]})]})]})]}),e.jsxs(_,{children:[e.jsx(w,{className:"pb-0"}),e.jsxs(S,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2 bg-muted p-3 rounded-lg",children:[e.jsx("div",{className:"",children:e.jsx("img",{className:"size-[40px] rounded-full object-cover",src:r.photo,alt:r.name})}),e.jsxs("div",{className:"grow flex flex-col",children:[e.jsx("span",{className:"font-semibold font-lg",children:r.name}),e.jsx("small",{className:"font-xs",children:r.phone})]})]}),e.jsxs("form",{onSubmit:z,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(n,{children:"Renewal Period (in months)"}),e.jsxs(b,{value:t.selected_months.toString(),onValueChange:d=>f("selected_months",Number(d)),children:[e.jsx(y,{id:"months",children:e.jsx(N,{placeholder:"Select duration"})}),e.jsxs(v,{children:[e.jsx(i,{value:"1",children:"1 Month"}),e.jsx(i,{value:"3",children:"3 Months"}),e.jsx(i,{value:"6",children:"6 Months"}),e.jsx(i,{value:"12",children:"1 Year"})]})]}),e.jsx(o,{message:u.selected_months})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Payment Proof (Optional)"}),e.jsx(h,{type:"file",onChange:d=>f("payment_proof",d.target.files?d.target.files[0]:null)}),e.jsx(o,{message:u.payment_proof})]}),e.jsx(g,{type:"submit",disabled:j,children:j?"Processing...":"Confirm Renewal"})]})]})]})]})]})})},de=oe;function Fe(){const[r,a]=c.useState(""),[l,t]=c.useState(null),f=new URLSearchParams(window.location.search),[p,u]=c.useState(!1),[M,j]=c.useState(f.get("form")==="renew"),k=async()=>{try{const x=await ae.get(`/get-renewal-form/${r}`);x.data.member?(t(x.data.member),j(!1),u(!0)):E({description:"Member not found or no active membership"})}catch{E({description:"Error fetching member data"})}};return e.jsxs(te,{attribute:"class",defaultTheme:"dark",enableSystem:!0,disableTransitionOnChange:!0,children:[e.jsxs("div",{className:"w-full h-screen bg-no-repeat bg-cover relative",style:{backgroundImage:"url('gym-bg.jpg')"},children:[e.jsx(se,{title:"Welcome to Chitwangym"}),e.jsx("div",{className:"absolute w-full min-h-full bg-black/60 text-white"}),e.jsxs("div",{className:"relative container min-h-full flex flex-col",children:[e.jsxs("div",{className:"py-7 flex justify-between items-center",children:[e.jsx($,{href:"/",className:"flex items-center py-3 px-5 w-fit",children:e.jsx("span",{className:"text-xl sm:text-2xl text-white font-semibold",children:"Chitwangym-Gaindakot"})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx($,{href:"/login",className:"text-sm text-gray-200 hover:underline",children:"Go to Admin Area"})})]}),e.jsx("div",{className:"grow flex items-center justify-center",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl lg:text-4xl xl:text-5xl text-center text-white font-extrabold uppercase",children:"Welcome to Chitwangym - Gaindakot"}),e.jsx("h3",{className:"text-white/75 text-center capitalize md:text-lg lg:text-xl font-semibold",children:"Your Fitness Journey Starts Here. Let's Achieve Your Goals Together."}),e.jsxs("div",{className:"flex gap-2 mx-auto justify-center",children:[e.jsx(ce,{})," ",e.jsxs(B,{open:M,onOpenChange:j,children:[e.jsxs(Q,{children:[e.jsx(g,{className:"md:hidden",size:"sm",children:"Renew Membership"}),e.jsx(g,{className:"hidden md:block",children:"Renew Membership"})]}),e.jsxs(H,{className:"space-y-1",children:[e.jsx("h2",{className:"font-bold",children:"Enter Phone Number to Renew"}),e.jsx(h,{type:"number",className:"flex-grow",onChange:x=>a(x.target.value),placeholder:"Phone number"}),e.jsx("div",{className:"text-end",children:e.jsx(g,{className:"me-auto",onClick:k,children:"Submit Renewal Request"})})]})]})]})]})})]})]}),e.jsx(ne,{}),l&&e.jsx(de,{member:l,open:p,onClose:()=>u(!1)})]})}export{Fe as default};
