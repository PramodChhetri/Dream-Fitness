import{W as Z,r as m,j as e,Y as $}from"./app-D3xhd7x4.js";import{I as i}from"./InputError-DKuUmmK1.js";import{B as ee}from"./button-kSVH6inc.js";import{C as y,a as E,b as D,d as w}from"./card-XJZW572Q.js";import{I as d}from"./input-B5jvm_hA.js";import{L as n}from"./label-B7b8UO_Y.js";import{S as h,a as u,b as x,c as p,d as t}from"./select-U6-rirhH.js";import{S as se}from"./SingleImageUploader-wXoJOceP.js";import{t as ae}from"./use-toast-CeK-EtdP.js";import{A as ne}from"./AuthenticatedLayout-BNoa_9Pl.js";import"./index-BN1U6-Hz.js";import"./index-Bb4qSo10.js";import"./utils-C-Zvzyq5.js";import"./index-BkFfMWl8.js";import"./index-CHWu3Xan.js";import"./index-DjfCHU90.js";import"./index-CQ59I0Dq.js";import"./index-D_4hUVl6.js";import"./createLucideIcon-RljSjpz3.js";import"./check-CcE03I2l.js";import"./GlobalLayout-CXzBAGyO.js";import"./toaster-FnjXybNn.js";import"./x-n02M-ldN.js";import"./sheet-KrgZSENa.js";import"./index-BA9ojx9c.js";import"./dropdown-menu-DbrUI8SI.js";const Fe=({auth:R,packages:j,lockers:f})=>{var A,M;const{data:a,setData:r,errors:l,post:V,processing:C,setError:re,clearErrors:I}=Z({name:"",phone:"",occupation:"",gender:"",marital_status:"",date_of_birth:new Date(new Date().setFullYear(new Date().getFullYear()-20)).toISOString().split("T")[0],address:"",preferred_time:"",membership_package:j[0].id,months:1,payment_mode:"",bill_number:0,extra_discount:0,photo:null,emergency_person_name:"",emergency_person_phone:"",locker_access:!1,locker_id:(A=f[0])==null?void 0:A.id,locker_discount:0,locker_number:"",paid:0,net_amount:0,days_count:1}),[q,L]=m.useState(0),[T,B]=m.useState(0),[G,O]=m.useState(0),[Q,U]=m.useState(0),[Y,H]=m.useState(0),[k,J]=m.useState(0),[W,S]=m.useState(0);m.useEffect(()=>{var c;const s=j.find(o=>o.id===a.membership_package);if(s){const o=Number(s.admission_amount)||0,g=Number(s.monthly_amount)||0,b=g*a.months,N=o+b;let _=0;a.months===3?_=Number(s.discount_quarterly)||0:a.months===6?_=Number(s.discount_half_yearly)||0:a.months===12&&(_=Number(s.discount_yearly)||0);const P=N-_,F=Math.min(a.extra_discount,P);L(o),B(g),O(b),U(N),H(_),J(P-F),r("extra_discount",F)}if(a.locker_access){const o=f.find(N=>N.id===a.locker_id),g=o?o.price:0,b=Math.min(a.locker_discount,g);S(g-b),r("locker_discount",b)}else S(0),r("locker_discount",0),r("locker_id",((c=f[0])==null?void 0:c.id)||1)},[a.membership_package,a.months,a.extra_discount,a.locker_access,a.locker_id,a.locker_discount,j,f]);const v=()=>Number(a.months)===0?a.net_amount:k+W,z=()=>{const s=v();return(a.paid||0)>s?"Advance Amount":"Credit Amount"},K=()=>{const s=v(),c=a.paid||0;return c>s?c-s:s-c},X=s=>{s.preventDefault(),I(),V("/member/store",{onSuccess:c=>{ae({description:"Member Created Successfully..."})}})};return e.jsxs(ne,{user:R.user,children:[e.jsx($,{title:"Create Member"}),e.jsxs("div",{className:"w-full mx-auto space-y-8",children:[e.jsx("div",{className:"flex justify-between",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Create a Membership"})}),e.jsx("form",{onSubmit:X,children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsxs("div",{className:"lg:col-span-6 xl:col-span-7 2xl:col-span-8 space-y-8",children:[e.jsxs(y,{children:[e.jsx(E,{children:e.jsx(D,{className:"text-lg",children:"Member Information"})}),e.jsxs(w,{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("div",{className:"w-32",children:[e.jsx(se,{onImageUpload:s=>r("photo",s),className:"aspect-square px-2 w-full",label:"Upload Member Photo"}),e.jsx(i,{message:l.photo,className:"mt-2"})]}),e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"name",children:"Name"}),e.jsx(d,{id:"name",value:a.name,onChange:s=>{const c=s.target.value.toLowerCase().replace(/\b\w/g,o=>o.toUpperCase());r("name",c)},placeholder:"Enter member's name",required:!0}),e.jsx(i,{message:l.name,className:"mt-2"}),e.jsx(n,{htmlFor:"address",children:"Address"}),e.jsx(d,{id:"address",value:a.address,onChange:s=>r("address",s.target.value),placeholder:"Enter address",required:!0}),e.jsx(i,{message:l.address,className:"mt-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"phone",children:"Phone"}),e.jsx(d,{id:"phone",value:a.phone,onChange:s=>r("phone",s.target.value),placeholder:"Enter phone number",required:!0,maxLength:10,minLength:10}),e.jsx(i,{message:l.phone,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"occupation",children:"Occupation"}),e.jsxs(h,{defaultValue:a.occupation,onValueChange:s=>r("occupation",s),children:[e.jsx(u,{id:"occupation",children:e.jsx(x,{placeholder:"Select occupation"})}),e.jsxs(p,{children:[e.jsx(t,{value:"private-job",children:"Private Job"}),e.jsx(t,{value:"government-job",children:"Government Job"}),e.jsx(t,{value:"business",children:"Business"}),e.jsx(t,{value:"student",children:"Student"}),e.jsx(t,{value:"housewife",children:"House Wife"}),e.jsx(t,{value:"other",children:"Other"})]})]}),e.jsx(i,{message:l.occupation,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Gender"}),e.jsxs(h,{defaultValue:a.gender,onValueChange:s=>r("gender",s),children:[e.jsx(u,{id:"gender",children:e.jsx(x,{placeholder:"Select gender"})}),e.jsxs(p,{children:[e.jsx(t,{value:"male",children:"Male"}),e.jsx(t,{value:"female",children:"Female"})]})]}),e.jsx(i,{message:l.gender,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Marital Status"}),e.jsxs(h,{defaultValue:a.marital_status,onValueChange:s=>r("marital_status",s),children:[e.jsx(u,{id:"marital_status",children:e.jsx(x,{placeholder:"Select marital status"})}),e.jsxs(p,{children:[e.jsx(t,{value:"single",children:"Single"}),e.jsx(t,{value:"married",children:"Married"})]})]}),e.jsx(i,{message:l.marital_status,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"date_of_birth",children:"Date of Birth"}),e.jsx(d,{id:"date_of_birth",type:"date",value:a.date_of_birth,onChange:s=>r("date_of_birth",s.target.value),required:!0}),e.jsx(i,{message:l.date_of_birth,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"preferred_time",children:"Preferred Shift"}),e.jsxs(h,{onValueChange:s=>r("preferred_time",s),children:[e.jsx(u,{children:e.jsx(x,{placeholder:"Select preferred shift"})}),e.jsxs(p,{children:[e.jsx(t,{value:"Morning",children:"Morning"}),e.jsx(t,{value:"Day",children:"Day"}),e.jsx(t,{value:"Evening",children:"Evening"})]})]}),e.jsx(i,{message:l.preferred_time,className:"mt-2"})]})]})]})]}),e.jsxs(y,{children:[e.jsx(E,{children:e.jsx(D,{className:"text-lg",children:"Membership and Payment Details"})}),e.jsxs(w,{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"membership_package",children:"Membership Package"}),e.jsxs(h,{defaultValue:a.membership_package.toString(),onValueChange:s=>r("membership_package",Number(s)),children:[e.jsx(u,{id:"membership_package",children:e.jsx(x,{placeholder:"Select membership package"})}),e.jsx(p,{children:j.map(s=>e.jsx(t,{value:s.id.toString(),children:s.package_name},s.id))})]}),e.jsx(i,{message:l.membership_package,className:"mt-2"})]}),e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"months",children:"Initial Registration Months"}),e.jsxs(h,{defaultValue:a.months.toString(),onValueChange:s=>r("months",Number(s)),children:[e.jsx(u,{id:"months",children:e.jsx(x,{placeholder:"Select membership months"})}),e.jsxs(p,{children:[e.jsx(t,{value:"1",children:"1 Month"}),e.jsx(t,{value:"3",children:"3 Months"}),e.jsx(t,{value:"6",children:"6 Months"}),e.jsx(t,{value:"12",children:"1 Year"}),e.jsx(t,{value:"0",children:"Temporary"})]})]}),e.jsx(i,{message:l.months,className:"mt-2"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"payment_mode",children:"Payment Mode"}),e.jsxs(h,{defaultValue:a.payment_mode,onValueChange:s=>r("payment_mode",s),children:[e.jsx(u,{id:"payment_mode",children:e.jsx(x,{placeholder:"Select payment mode"})}),e.jsxs(p,{children:[e.jsx(t,{value:"Cash",children:"Cash"}),e.jsx(t,{value:"QR",children:"QR"}),e.jsx(t,{value:"Cash + QR",children:"Cash + QR"}),e.jsx(t,{value:"Cheque",children:"Cheque"})]})]}),e.jsx(i,{message:l.payment_mode,className:"mt-2"})]}),e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"bill_number",children:"Bill Number"}),e.jsx(d,{id:"bill_number",type:"number",onChange:s=>r("bill_number",Number(s.target.value)),placeholder:"Enter bill number"}),e.jsx(i,{message:l.bill_number,className:"mt-2"})]}),a.months>0?e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"extra_discount",children:"Extra Discount"}),e.jsx(d,{id:"extra_discount",type:"number",onChange:s=>r("extra_discount",Number(s.target.value)),placeholder:"Enter extra discount"}),e.jsx(i,{message:l.extra_discount,className:"mt-2"})]}):e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"days_count",children:"Days Count"}),e.jsx(d,{id:"days_count",placeholder:"Enter total number of days",type:"number",onChange:s=>r("days_count",Number(s.target.value)),required:!0,min:new Date(Date.now()+864e5).toISOString().split("T")[0]}),e.jsx(i,{message:l.days_count,className:"mt-2"})]})]})]})]})]}),e.jsxs("div",{className:"lg:col-span-6 xl:col-span-5 2xl:col-span-4 space-y-2",children:[e.jsx(y,{children:e.jsxs(w,{className:"gap-2 flex flex-col flex-wrap",children:[e.jsx("div",{className:"text-lg mb-2 mt-2",children:e.jsx("strong",{children:"Emergency Information"})}),e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"emergency_person_name",children:"Person Name"}),e.jsx(d,{id:"emergency_person_name",value:a.emergency_person_name,onChange:s=>r("emergency_person_name",s.target.value),placeholder:"Enter emergency contact person name"}),e.jsx(i,{message:l.emergency_person_name,className:"mt-2"})]}),e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"emergency_person_phone",children:"Phone"}),e.jsx(d,{id:"emergency_person_phone",value:a.emergency_person_phone,onChange:s=>r("emergency_person_phone",s.target.value),placeholder:"Enter emergency contact phone number"}),e.jsx(i,{message:l.emergency_person_phone,className:"mt-2"})]})]})}),e.jsx(y,{children:e.jsxs(w,{children:[e.jsx("div",{className:"text-lg mb-2 mt-2",children:e.jsx("strong",{children:"Pricing Summary"})}),e.jsx("div",{className:"text-start mb-1",children:e.jsx("strong",{children:(M=j.find(s=>s.id===a.membership_package))==null?void 0:M.package_name})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Admission Amount"}),e.jsxs("span",{children:["Rs ",q]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Monthly Amount"}),e.jsxs("span",{children:["Rs ",T]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Total Months"}),e.jsxs("span",{children:[a.months," Months"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Total Monthly Fees"}),e.jsxs("span",{children:["Rs ",G]})]}),e.jsx("div",{className:"border mb-2"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Gross Package Amount"}),e.jsxs("span",{children:["Rs ",Q]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Package Discount"}),e.jsxs("span",{children:["- Rs ",Y]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Extra Discount"}),e.jsxs("span",{children:["- Rs ",a.extra_discount]})]}),e.jsx("div",{className:"border mb-2"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Net Package Amount"}),e.jsxs("span",{children:["Rs ",k]})]}),e.jsx("div",{className:"border mb-2"}),e.jsxs("strong",{className:"flex justify-between",children:[e.jsx(n,{children:"Net Amount"}),a.months>0?e.jsxs("span",{className:"cursor-pointer",onClick:()=>r("paid",v()),children:["Rs ",v()]}):e.jsx("input",{id:"paidAmount",className:"w-fit max-w-48 text-end border-0 border-b-2 focus:ring-0  [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",type:"number",min:0,placeholder:"Enter Net Amount",onChange:s=>r("net_amount",Number(s.target.value))})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Paid Amount (Rs)"}),e.jsx("input",{id:"paidAmount",className:"w-fit max-w-48 text-end border-0 border-b-2 focus:ring-0  [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",type:"number",min:0,placeholder:"Enter Paid Amount",value:a.paid||"",onChange:s=>r("paid",Number(s.target.value))}),e.jsx(i,{message:l.paid,className:"mt-2"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:z()}),e.jsxs("span",{children:["Rs ",K()]})]}),e.jsx(ee,{type:"submit",disabled:C,className:"w-full mt-3",children:C?"Processing...":"Confirm and Register"})]})})]})]})})]})]})};export{Fe as default};
