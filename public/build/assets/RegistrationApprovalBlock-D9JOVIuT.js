import{r as m,W as B,j as e}from"./app-MbUP1EQI.js";import{C as x,a as h,b as u,d as j}from"./card-K8Ff7zdG.js";import{D as F,a as T,b as Q,c as L,d as O,e as H,f as V}from"./dialog-Bcf4xQSo.js";import{S as G,a as W,b as J,c as K,d as p}from"./select-DuLVWfqX.js";import{I as b}from"./input-BPMtujBP.js";import{B as P}from"./button-CzAhYwEo.js";import{L as f}from"./label-DUXNj4de.js";import{I as g}from"./InputError-BAx_On6R.js";import{t as y}from"./use-toast-BPI7qPE7.js";import{P as U,a as X,b as Y}from"./popover-BLZzaaGK.js";import{C as Z}from"./circle-check-big-xZGLDr-S.js";import"./utils-C-Zvzyq5.js";import"./index-DrAYGk9J.js";import"./index-50k3gDpb.js";import"./index-ynk8XwVw.js";import"./index-B2Mnvzit.js";import"./x-BkjT11oR.js";import"./createLucideIcon-DhDSKE00.js";import"./index-CrW0pUbx.js";import"./index-BBBSSME7.js";import"./check-BQwKtKwj.js";import"./index-DHdUJXuL.js";import"./index-Bb4qSo10.js";const ye=({application:s})=>{s.member;const N=m.useRef(null),{data:r,setData:n,reset:D,errors:c,post:S,processing:v,clearErrors:A}=B({extra_discount:0,paid:0,bill_number:"",payment_mode:"Cash"}),i=s.membership_package||{},_=Number(i.admission_amount),d=Number(s.months),C=Number(i.monthly_amount)||0,w=d*C;let t=0;switch(d){case 3:t=Number(i.discount_quarterly)||0;break;case 6:t=Number(i.discount_half_yearly)||0;break;case 12:t=Number(i.discount_yearly)||0;break;default:t=0}const[o,E]=m.useState(0),l=_+w-t;m.useEffect(()=>{l&&(n("extra_discount",Math.max(0,r.extra_discount)),n("paid",Math.max(0,r.paid)),E(l-Number(r.extra_discount)))},[r.extra_discount,r.paid]);const M=()=>r.paid>o?"Advance Amount":"Credit Amount",k=()=>r.paid>o?r.paid-o:o-r.paid,q=a=>{if(a.preventDefault(),!v){if(A(),!r.payment_mode||!r.bill_number||r.paid<=0){y({description:"Please fill in all required fields correctly.",variant:"destructive"});return}S(route("public-registration.confirm",s.id),{onSuccess:()=>{y({description:"Renewal request confirmed successfully."}),R(!1),D()},onError:I=>{console.error(I),y({description:"An error occurred during submission.",variant:"destructive"})}})}},[z,R]=m.useState(!1);return e.jsxs(F,{open:z,onOpenChange:R,children:[e.jsx(T,{children:e.jsx(P,{size:"icon",variant:"ghost",children:e.jsx(Z,{className:"text-primary"})})}),e.jsxs(Q,{className:"max-w-4xl w-[95vw] mx-auto rounded-lg p-6 shadow-lg overflow-auto max-h-[95vh]",children:[e.jsxs(L,{children:[e.jsx(O,{className:"text-xl font-semibold",children:"Confirm Registration Request"}),e.jsxs(H,{className:"text-sm",children:["Confirm the renewal request for ",e.jsx("strong",{children:s.name}),"."]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mt-4",children:[e.jsx("div",{className:"col-span-full",children:e.jsxs(x,{children:[e.jsx(h,{children:e.jsx(u,{children:"Personal Information"})}),e.jsxs(j,{className:"grid grid-cols-3",children:[e.jsxs("div",{className:"space-y-4 lg:col-span-2",children:[e.jsxs("div",{className:"flex flex-wrap gap-4",children:[e.jsx("img",{src:s.photo,className:"size-24 rounded object-cover bg-muted"}),e.jsxs("div",{children:[e.jsxs("div",{className:"space-x-2 text-xl",children:[e.jsx("span",{children:"Name:"}),e.jsx("strong",{children:s.name})]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx("span",{children:"Phone:"}),e.jsx("strong",{className:"text-muted-foreground",children:s.phone})]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx("span",{children:"Address:"}),e.jsx("strong",{className:"text-muted-foreground",children:s.address})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"space-x-2",children:[e.jsx("span",{children:"Occupation:"}),e.jsx("strong",{className:"text-muted-foreground capitalize",children:s.occupation})]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx("span",{children:"Gender:"}),e.jsx("strong",{className:"text-muted-foreground capitalize",children:s.gender})]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx("span",{children:"Marital Status:"}),e.jsx("strong",{className:"text-muted-foreground capitalize",children:s.marital_status})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"space-x-2",children:[e.jsx("span",{children:"Date of Birth:"}),e.jsx("strong",{className:"text-muted-foreground capitalize",children:s.date_of_birth})]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx("span",{children:"Preferred Time:"}),e.jsx("strong",{className:"text-muted-foreground capitalize",children:s.preferred_time})]})]}),e.jsx("div",{})]})]}),e.jsxs(x,{className:"bg-muted",children:[e.jsx(h,{className:"pb-1",children:e.jsx(u,{className:"text-lg",children:"Emergency Information"})}),e.jsx(j,{className:"overflow-hidden",children:e.jsxs("div",{children:[e.jsxs("div",{className:"space-x-2",children:[e.jsx("span",{children:"Name:"}),e.jsx("strong",{className:"capitalize",children:s.emergency_person_name})]}),e.jsxs("div",{className:"space-x-2",children:[e.jsx("span",{children:"Phone:"}),e.jsx("strong",{className:"text-muted-foreground",children:s.emergency_person_phone})]})]})})]})]})]})}),e.jsxs(x,{children:[e.jsxs(h,{className:"flex flex-row justify-between",children:[e.jsx(u,{className:"text-lg font-semibold",children:"Pricing Summary"}),e.jsx("div",{children:e.jsxs(U,{children:[e.jsx(X,{children:e.jsx("a",{href:"javascript:",children:e.jsx("u",{children:"Payment Proof"})})}),e.jsx(Y,{className:"border rounded-md size-[370px]",children:e.jsx("img",{src:s.payment_proof,alt:"Payment Proof",className:"object-contain w-full h-full border"})})]})})]}),e.jsxs(j,{children:[e.jsx("b",{children:i.package_name||"N/A"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Requested initial subscription"}),e.jsxs("strong",{children:[d," ",d===1?"Month":"Months"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Admission Fees"}),e.jsxs("strong",{children:["Rs ",_]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Monthly Fees"}),e.jsxs("strong",{children:["Rs ",C]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Calculated Monthly Fees"}),e.jsxs("strong",{children:["Rs ",w]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Package Discount"}),e.jsxs("strong",{children:["- Rs ",t]})]}),e.jsx("div",{className:"border-t my-2"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Actual Receivable"}),e.jsxs("b",{className:"cursor-pointer",onClick:()=>{N.current&&(n("paid",l),N.current.value=l.toString())},children:["Rs ",l]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Received Amount"}),e.jsxs("span",{children:["Rs ",r.paid]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Extra Discount"}),e.jsxs("span",{children:["- Rs ",r.extra_discount]})]}),e.jsx("div",{className:"border-t my-2"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:M()}),e.jsxs("span",{children:["Rs ",k()]})]})]})]}),e.jsxs(x,{children:[e.jsx(h,{children:e.jsx(u,{className:"text-lg",children:"Payment Information"})}),e.jsx(j,{className:"space-y-4",children:e.jsxs("form",{onSubmit:q,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(f,{children:"Payment Method"}),e.jsxs(G,{value:r.payment_mode,onValueChange:a=>n("payment_mode",a),children:[e.jsx(W,{id:"payment-method",children:e.jsx(J,{placeholder:"Select payment method"})}),e.jsxs(K,{children:[e.jsx(p,{value:"QR",children:"QR"}),e.jsx(p,{value:"Cash",children:"Cash"}),e.jsx(p,{value:"Cash + QR",children:"Cash + QR"}),e.jsx(p,{value:"Cheque",children:"Cheque"})]})]}),e.jsx(g,{message:c.payment_mode})]}),e.jsxs("div",{children:[e.jsx(f,{children:"Bill Number"}),e.jsx(b,{required:!0,type:"text",placeholder:"Enter bill number",onChange:a=>n("bill_number",a.target.value)}),e.jsx(g,{message:c.bill_number})]}),e.jsxs("div",{className:"flex gap-x-1 gap-y-2 flex-wrap",children:[e.jsxs("div",{className:"grow",children:[e.jsx(f,{children:"Extra Discount"}),e.jsx(b,{type:"number",placeholder:"Enter extra discount",onChange:a=>n("extra_discount",Math.max(0,Number(a.target.value)))}),e.jsx(g,{message:c.extra_discount})]}),e.jsxs("div",{className:"grow",children:[e.jsx(f,{children:"Received Amount"}),e.jsx(b,{required:!0,type:"number",placeholder:"Enter amount",ref:N,onChange:a=>n("paid",Math.max(0,Number(a.target.value)))}),e.jsx(g,{message:c.paid})]})]}),e.jsx(P,{disabled:v,children:v?"Processing...":"Confirm Renewal"})]})})]})]}),e.jsx(V,{})]})]})};export{ye as default};
