import{W as se,r as h,j as e,Y as ae}from"./app-BbJUaZt7.js";import{I as c}from"./InputError-NIrKKB-2.js";import{B as ne}from"./button-UwysrHzP.js";import{C as v,a as N,b as y,d as k}from"./card-BdKu3Mnk.js";import{C as re}from"./checkbox-D4co0-9i.js";import{I as i}from"./input-Cqv19wrC.js";import{L as n}from"./label-DsFCVgVZ.js";import{S as u,a as x,b as j,c as p,d as t}from"./select-Dfz_2K3P.js";import{S as te}from"./SingleImageUploader-DEOVZYoh.js";import{t as le}from"./use-toast-DB_HyPaF.js";import{A as ce}from"./AuthenticatedLayout-DVjcb06X.js";import"./index-8PO45I_3.js";import"./index-Bb4qSo10.js";import"./utils-C-Zvzyq5.js";import"./check-DjI-pqQE.js";import"./createLucideIcon-CPw1ASD4.js";import"./index-B95Fhcwf.js";import"./index-DJQKv4up.js";import"./index-CXD2mk9O.js";import"./index-BM2NL8vz.js";import"./index-C1KCpwI9.js";import"./GlobalLayout-DH3BRBnV.js";import"./toaster-D0flyv3P.js";import"./x-Dzg8clAH.js";import"./sheet-BMmGqGqr.js";import"./index-BAXoe19z.js";import"./dropdown-menu-B8xy7AqL.js";const Ve=({auth:I,packages:g,lockers:m})=>{var P,F,E,D,R;const{data:a,setData:r,errors:l,post:q,processing:S,setError:ie,clearErrors:T}=se({name:"",phone:"",occupation:"",gender:"",marital_status:"",date_of_birth:new Date(new Date().setFullYear(new Date().getFullYear()-20)).toISOString().split("T")[0],address:"",preferred_time:"",membership_package:g[0].id,months:1,payment_mode:"",bill_number:0,extra_discount:0,photo:null,emergency_person_name:"",emergency_person_phone:"",locker_access:!1,locker_id:(P=m[0])==null?void 0:P.id,locker_discount:0,locker_number:"",paid:0,net_amount:0,days_count:1}),[B,G]=h.useState(0),[O,Q]=h.useState(0),[U,Y]=h.useState(0),[H,J]=h.useState(0),[W,z]=h.useState(0),[A,K]=h.useState(0),[X,M]=h.useState(0);h.useEffect(()=>{var o;const s=g.find(d=>d.id===a.membership_package);if(s){const d=Number(s.admission_amount)||0,_=Number(s.monthly_amount)||0,b=_*a.months,w=d+b;let f=0;a.months===3?f=Number(s.discount_quarterly)||0:a.months===6?f=Number(s.discount_half_yearly)||0:a.months===12&&(f=Number(s.discount_yearly)||0);const L=w-f,V=Math.min(a.extra_discount,L);G(d),Q(_),Y(b),J(w),z(f),K(L-V),r("extra_discount",V)}if(a.locker_access){const d=m.find(w=>w.id===a.locker_id),_=d?d.price:0,b=Math.min(a.locker_discount,_);M(_-b),r("locker_discount",b)}else M(0),r("locker_discount",0),r("locker_id",((o=m[0])==null?void 0:o.id)||1)},[a.membership_package,a.months,a.extra_discount,a.locker_access,a.locker_id,a.locker_discount,g,m]);const C=()=>Number(a.months)===0?a.net_amount:A+X,Z=()=>{const s=C();return(a.paid||0)>s?"Advance Amount":"Credit Amount"},$=()=>{const s=C(),o=a.paid||0;return o>s?o-s:s-o},ee=s=>{s.preventDefault(),T(),q("/member/store",{onSuccess:o=>{le({description:"Member Created Successfully..."})}})};return e.jsxs(ce,{user:I.user,children:[e.jsx(ae,{title:"Create Member"}),e.jsxs("div",{className:"w-full mx-auto space-y-6",children:[e.jsx("div",{className:"flex justify-between",children:e.jsx("h1",{className:"text-2xl font-bold",children:"Create a Membership"})}),e.jsx("form",{onSubmit:ee,children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsxs("div",{className:"lg:col-span-6 xl:col-span-7 2xl:col-span-8 space-y-6",children:[e.jsxs(v,{children:[e.jsx(N,{children:e.jsx(y,{className:"text-lg",children:"Member Information"})}),e.jsxs(k,{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("div",{className:"w-32",children:[e.jsx(te,{onImageUpload:s=>r("photo",s),className:"aspect-square px-2 w-full",label:"Upload Member Photo"}),e.jsx(c,{message:l.photo,className:"mt-2"})]}),e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"name",children:"Name"}),e.jsx(i,{id:"name",value:a.name,onChange:s=>{const o=s.target.value.toLowerCase().replace(/\b\w/g,d=>d.toUpperCase());r("name",o)},placeholder:"Enter member's name",required:!0}),e.jsx(c,{message:l.name,className:"mt-2"}),e.jsx(n,{htmlFor:"address",children:"Address"}),e.jsx(i,{id:"address",value:a.address,onChange:s=>r("address",s.target.value),placeholder:"Enter address",required:!0}),e.jsx(c,{message:l.address,className:"mt-2"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"phone",children:"Phone"}),e.jsx(i,{id:"phone",value:a.phone,onChange:s=>r("phone",s.target.value),placeholder:"Enter phone number",required:!0,maxLength:10,minLength:10}),e.jsx(c,{message:l.phone,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"occupation",children:"Occupation"}),e.jsxs(u,{defaultValue:a.occupation,onValueChange:s=>r("occupation",s),children:[e.jsx(x,{id:"occupation",children:e.jsx(j,{placeholder:"Select occupation"})}),e.jsxs(p,{children:[e.jsx(t,{value:"private-job",children:"Private Job"}),e.jsx(t,{value:"government-job",children:"Government Job"}),e.jsx(t,{value:"business",children:"Business"}),e.jsx(t,{value:"student",children:"Student"}),e.jsx(t,{value:"housewife",children:"House Wife"}),e.jsx(t,{value:"other",children:"Other"})]})]}),e.jsx(c,{message:l.occupation,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Gender"}),e.jsxs(u,{defaultValue:a.gender,onValueChange:s=>r("gender",s),children:[e.jsx(x,{id:"gender",children:e.jsx(j,{placeholder:"Select gender"})}),e.jsxs(p,{children:[e.jsx(t,{value:"male",children:"Male"}),e.jsx(t,{value:"female",children:"Female"})]})]}),e.jsx(c,{message:l.gender,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{children:"Marital Status"}),e.jsxs(u,{defaultValue:a.marital_status,onValueChange:s=>r("marital_status",s),children:[e.jsx(x,{id:"marital_status",children:e.jsx(j,{placeholder:"Select marital status"})}),e.jsxs(p,{children:[e.jsx(t,{value:"single",children:"Single"}),e.jsx(t,{value:"married",children:"Married"})]})]}),e.jsx(c,{message:l.marital_status,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"date_of_birth",children:"Date of Birth"}),e.jsx(i,{id:"date_of_birth",type:"date",value:a.date_of_birth,onChange:s=>r("date_of_birth",s.target.value),required:!0}),e.jsx(c,{message:l.date_of_birth,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"preferred_time",children:"Preferred Shift"}),e.jsxs(u,{onValueChange:s=>r("preferred_time",s),children:[e.jsx(x,{children:e.jsx(j,{placeholder:"Select preferred shift"})}),e.jsxs(p,{children:[e.jsx(t,{value:"Morning",children:"Morning"}),e.jsx(t,{value:"Day",children:"Day"}),e.jsx(t,{value:"Evening",children:"Evening"})]})]}),e.jsx(c,{message:l.preferred_time,className:"mt-2"})]})]})]})]}),e.jsxs(v,{children:[e.jsx(N,{children:e.jsx(y,{className:"text-lg",children:"Membership and Payment Details"})}),e.jsxs(k,{className:"space-y-2",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"membership_package",children:"Membership Package"}),e.jsxs(u,{defaultValue:a.membership_package.toString(),onValueChange:s=>r("membership_package",Number(s)),children:[e.jsx(x,{id:"membership_package",children:e.jsx(j,{placeholder:"Select membership package"})}),e.jsx(p,{children:g.map(s=>e.jsx(t,{value:s.id.toString(),children:s.package_name},s.id))})]}),e.jsx(c,{message:l.membership_package,className:"mt-2"})]}),e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"months",children:"Initial Registration Months"}),e.jsxs(u,{defaultValue:a.months.toString(),onValueChange:s=>r("months",Number(s)),children:[e.jsx(x,{id:"months",children:e.jsx(j,{placeholder:"Select membership months"})}),e.jsxs(p,{children:[e.jsx(t,{value:"1",children:"1 Month"}),e.jsx(t,{value:"3",children:"3 Months"}),e.jsx(t,{value:"6",children:"6 Months"}),e.jsx(t,{value:"12",children:"1 Year"}),e.jsx(t,{value:"0",children:"Temporary"})]})]}),e.jsx(c,{message:l.months,className:"mt-2"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"payment_mode",children:"Payment Mode"}),e.jsxs(u,{defaultValue:a.payment_mode,onValueChange:s=>r("payment_mode",s),children:[e.jsx(x,{id:"payment_mode",children:e.jsx(j,{placeholder:"Select payment mode"})}),e.jsxs(p,{children:[e.jsx(t,{value:"Cash",children:"Cash"}),e.jsx(t,{value:"QR",children:"QR"}),e.jsx(t,{value:"Cash + QR",children:"Cash + QR"}),e.jsx(t,{value:"Cheque",children:"Cheque"})]})]}),e.jsx(c,{message:l.payment_mode,className:"mt-2"})]}),e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"bill_number",children:"Bill Number"}),e.jsx(i,{id:"bill_number",type:"number",onChange:s=>r("bill_number",Number(s.target.value)),placeholder:"Enter bill number"}),e.jsx(c,{message:l.bill_number,className:"mt-2"})]}),a.months>0?e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"extra_discount",children:"Extra Discount"}),e.jsx(i,{id:"extra_discount",type:"number",onChange:s=>r("extra_discount",Number(s.target.value)),placeholder:"Enter extra discount"}),e.jsx(c,{message:l.extra_discount,className:"mt-2"})]}):e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"days_count",children:"Days Count"}),e.jsx(i,{id:"days_count",placeholder:"Enter total number of days",type:"number",onChange:s=>r("days_count",Number(s.target.value)),required:!0,min:new Date(Date.now()+864e5).toISOString().split("T")[0]}),e.jsx(c,{message:l.days_count,className:"mt-2"})]})]})]})]}),e.jsxs(v,{children:[e.jsx(N,{children:e.jsx(y,{className:"text-lg",children:"Locker Information"})}),e.jsxs(k,{className:"space-y-2",children:[e.jsxs(n,{className:"flex gap-2 items-center",children:[e.jsx(re,{checked:a.locker_access,onCheckedChange:()=>r("locker_access",!a.locker_access)}),"Provide Locker Access"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"grow",children:[e.jsx(n,{children:"Provide Locker Access for"}),e.jsxs(u,{disabled:!a.locker_access,defaultValue:(F=m[0])==null?void 0:F.id.toString(),onValueChange:s=>r("locker_id",Number(s)),value:a.locker_id.toString(),children:[e.jsx(x,{children:e.jsx(j,{placeholder:"Select accessible months"})}),e.jsx(p,{children:m.map(s=>e.jsxs(t,{value:s.id.toString(),children:[s.months," ",s.months===1?"Month":"Months"," in Rs ",s.price]},s.id))})]}),e.jsx(c,{message:l.locker_id,className:"mt-2"})]}),e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"locker_number",children:"Locker Number"}),e.jsx(i,{id:"locker_number",type:"text",value:a.locker_number||"",disabled:!a.locker_access,onChange:s=>r("locker_number",s.target.value),placeholder:"Enter Locker Number"}),e.jsx(c,{message:l.locker_number,className:"mt-2"})]}),e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"locker_discount",children:"Locker Discount"}),e.jsx(i,{id:"locker_discount",type:"number",disabled:!a.locker_access,onChange:s=>r("locker_discount",Number(s.target.value)),placeholder:"Enter locker discount"}),e.jsx(c,{message:l.locker_discount,className:"mt-2"})]})]})]})]})]}),e.jsxs("div",{className:"lg:col-span-6 xl:col-span-5 2xl:col-span-4 space-y-6",children:[e.jsxs(v,{children:[e.jsx(N,{children:e.jsx(y,{className:"text-lg",children:"Emergency Information"})}),e.jsxs(k,{className:"gap-2 flex flex-col flex-wrap",children:[e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"emergency_person_name",children:"Person Name"}),e.jsx(i,{id:"emergency_person_name",value:a.emergency_person_name,onChange:s=>r("emergency_person_name",s.target.value),placeholder:"Enter emergency contact person name"}),e.jsx(c,{message:l.emergency_person_name,className:"mt-2"})]}),e.jsxs("div",{className:"grow",children:[e.jsx(n,{htmlFor:"emergency_person_phone",children:"Phone"}),e.jsx(i,{id:"emergency_person_phone",value:a.emergency_person_phone,onChange:s=>r("emergency_person_phone",s.target.value),placeholder:"Enter emergency contact phone number"}),e.jsx(c,{message:l.emergency_person_phone,className:"mt-2"})]})]})]}),e.jsxs(v,{children:[e.jsx(N,{children:e.jsx(y,{className:"text-lg",children:"Pricing and Payment"})}),e.jsxs(k,{children:[e.jsx("div",{className:"text-start mb-3",children:e.jsx("strong",{children:(E=g.find(s=>s.id===a.membership_package))==null?void 0:E.package_name})}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Admission Amount"}),e.jsxs("span",{children:["Rs ",B]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Monthly Amount"}),e.jsxs("span",{children:["Rs ",O]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Total Months"}),e.jsxs("span",{children:[a.months," Months"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Total Monthly Fees"}),e.jsxs("span",{children:["Rs ",U]})]}),e.jsx("div",{className:"border mb-2"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Gross Package Amount"}),e.jsxs("span",{children:["Rs ",H]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Package Discount"}),e.jsxs("span",{children:["- Rs ",W]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Extra Discount"}),e.jsxs("span",{children:["- Rs ",a.extra_discount]})]}),e.jsx("div",{className:"border mb-2"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Net Package Amount"}),e.jsxs("span",{children:["Rs ",A]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(n,{children:["Locker Charge (",a.locker_access?(D=m.find(s=>s.id===a.locker_id))==null?void 0:D.months:0," Months)"]}),e.jsxs("span",{children:["Rs ",a.locker_access?(R=m.find(s=>s.id===a.locker_id))==null?void 0:R.price:0]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Locker Discount"}),e.jsxs("span",{children:["- Rs ",a.locker_access?a.locker_discount:0]})]}),e.jsx("div",{className:"border mb-2"}),e.jsxs("strong",{className:"flex justify-between",children:[e.jsx(n,{children:"Net Amount"}),a.months>0?e.jsxs("span",{className:"cursor-pointer",onClick:()=>r("paid",C()),children:["Rs ",C()]}):e.jsx("input",{id:"paidAmount",className:"w-fit max-w-48 text-end border-0 border-b-2 focus:ring-0  [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",type:"number",min:0,placeholder:"Enter Net Amount",onChange:s=>r("net_amount",Number(s.target.value))})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:"Paid Amount (Rs)"}),e.jsx("input",{id:"paidAmount",className:"w-fit max-w-48 text-end border-0 border-b-2 focus:ring-0  [appearance:textfield] [&::-webkit-outer-spin-button]:appearance-none [&::-webkit-inner-spin-button]:appearance-none",type:"number",min:0,placeholder:"Enter Paid Amount",value:a.paid||"",onChange:s=>r("paid",Number(s.target.value))}),e.jsx(c,{message:l.paid,className:"mt-2"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx(n,{children:Z()}),e.jsxs("span",{children:["Rs ",$()]})]}),e.jsx(ne,{type:"submit",disabled:S,className:"w-full mt-3",children:S?"Processing...":"Confirm and Register"})]})]})]})]})})]})]})};export{Ve as default};
