import{r as M,j as e,Y as U,y as S,W as A,d as I}from"./app-D3xhd7x4.js";import{A as $}from"./AuthenticatedLayout-BNoa_9Pl.js";import{C as z,a as q,b as O,c as W,d as u}from"./card-XJZW572Q.js";import{T as D,a as N,b as a,c as r,d as y,e as n}from"./table-nOQc-wFK.js";import{T as Y,a as G,b as f}from"./tabs-DOiJwsDM.js";import{B as v}from"./button-kSVH6inc.js";import{L as J}from"./loader-C1KRAxJu.js";import K from"./TransactionDialog-E3akbY2f.js";import{B as o}from"./badge-BnluvayJ.js";import{P as E,a as w,b as P}from"./popover-CpbQxDBy.js";import{L as C}from"./label-B7b8UO_Y.js";import{I as L}from"./input-B5jvm_hA.js";import{F as Q}from"./filter-DWFBunVn.js";import{c as X}from"./createLucideIcon-RljSjpz3.js";import{f as R}from"./format-CE4V3joc.js";import"./GlobalLayout-CXzBAGyO.js";import"./toaster-FnjXybNn.js";import"./index-BkFfMWl8.js";import"./index-CHWu3Xan.js";import"./index-DjfCHU90.js";import"./x-n02M-ldN.js";import"./index-Bb4qSo10.js";import"./utils-C-Zvzyq5.js";import"./use-toast-CeK-EtdP.js";import"./sheet-KrgZSENa.js";import"./index-BA9ojx9c.js";import"./index-D_4hUVl6.js";import"./dropdown-menu-DbrUI8SI.js";import"./index-CQ59I0Dq.js";import"./check-CcE03I2l.js";import"./index-BN1U6-Hz.js";import"./InputError-DKuUmmK1.js";import"./dialog-CoUukDiU.js";import"./select-U6-rirhH.js";import"./textarea-lKWceivU.js";/**
 * @license lucide-react v0.368.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=X("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);function Ie({auth:l,data:s,activeTab:i}){const[t,x]=M.useState(i||"registrations"),[k,g]=M.useState(!0),B=d=>{g(!0),x(d),S.get(route("transactions.index"),{tab:d},{onFinish:()=>g(!1)})};M.useEffect(()=>{g(!1)},[]);const F=d=>{d&&(g(!0),S.visit(d,{onFinish:()=>g(!1),preserveState:!0,preserveScroll:!0}))},V=()=>{const d=new URLSearchParams(window.location.search),p=d.get("filter[startDate]")||"",T=d.get("filter[endDate]")||"",{data:h,setData:m,errors:b}=A({startDate:p,endDate:T}),_=j=>{j.preventDefault();let c=new URLSearchParams(window.location.search);h.startDate?c.set("filter[startDate]",h.startDate):c.delete("filter[startDate]"),h.endDate?c.set("filter[endDate]",h.endDate):c.delete("filter[endDate]"),S.visit(route("transactions.index")+"?"+c.toString())};return M.useEffect(()=>{h.startDate||m("startDate",p),h.endDate||m("endDate",T)},[m,p,T]),e.jsxs(E,{children:[e.jsx(w,{asChild:!0,children:e.jsxs(v,{variant:"secondary",className:"flex items-center",children:[e.jsx(Q,{className:"size-4 me-2"})," Filter"]})}),e.jsx(P,{className:"w-fit",children:e.jsxs("form",{className:"flex gap-2 items-end",onSubmit:_,children:[e.jsxs("div",{children:[e.jsx(C,{children:"Start Date"}),e.jsx(L,{type:"date",value:h.startDate||"",onChange:j=>m("startDate",j.target.value)})]}),e.jsxs("div",{children:[e.jsx(C,{children:"End Date"}),e.jsx(L,{type:"date",value:h.endDate||"",onChange:j=>m("endDate",j.target.value)})]}),e.jsx("div",{children:e.jsx(v,{type:"submit",className:"w-full",children:"Filter"})})]})})]})},H=()=>{const{data:d,setData:p,post:T,processing:h}=A({startDate:"",endDate:""}),m=async b=>{b.preventDefault();try{const _=await I.post("/export-transactions",{startDate:d.startDate,endDate:d.endDate},{responseType:"blob"}),j=window.URL.createObjectURL(new Blob([_.data])),c=document.createElement("a");c.href=j,c.setAttribute("download",`income-expense-statement-${d.startDate}-to-${d.endDate}.xlsx`),document.body.appendChild(c),c.click(),c.remove()}catch(_){console.error("Error exporting data:",_)}};return e.jsxs(E,{children:[e.jsx(w,{asChild:!0,children:e.jsxs(v,{variant:"secondary",className:"flex items-center",children:[e.jsx(Z,{className:"size-4 me-2"})," Export"]})}),e.jsx(P,{className:"w-fit",children:e.jsxs("form",{className:"flex gap-2 items-end",onSubmit:m,children:[e.jsxs("div",{children:[e.jsx(C,{children:"Start Date"}),e.jsx(L,{type:"date",value:d.startDate||"",onChange:b=>p("startDate",b.target.value)})]}),e.jsxs("div",{children:[e.jsx(C,{children:"End Date"}),e.jsx(L,{type:"date",value:d.endDate||"",onChange:b=>p("endDate",b.target.value)})]}),e.jsx("div",{children:e.jsx(v,{type:"submit",className:"w-full",children:"Export"})})]})})]})};return e.jsxs($,{user:l.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Transactions"}),children:[e.jsx(U,{title:"Transactions"}),e.jsxs(z,{children:[e.jsxs(q,{className:"flex justify-between flex-row",children:[e.jsxs("div",{children:[e.jsx(O,{children:"Transactions"}),e.jsx(W,{children:"View and manage gym transactions"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(H,{}),e.jsx(V,{}),e.jsx(K,{})]})]}),e.jsx(u,{children:e.jsxs(Y,{value:t,onValueChange:B,children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(G,{children:[e.jsx(f,{value:"registrations",children:"Registrations"}),e.jsx(f,{value:"renewals",children:"Renewals"}),e.jsx(f,{value:"lockers",children:"Lockers"}),e.jsx(f,{value:"miscellaneous",children:"Miscellaneous"}),e.jsx(f,{value:"refunds",children:"Refunds"}),e.jsx(f,{value:"expenses",children:"Expenses"})]}),e.jsxs("span",{children:["showing ",s.data.length," of ",s.total," records"]})]}),k?e.jsx("div",{className:"flex justify-center items-center my-10",children:e.jsx(J,{size:"lg"})}):e.jsxs(e.Fragment,{children:[t==="registrations"&&ee(s),t==="renewals"&&re(s),t==="lockers"&&se(s),t==="miscellaneous"&&ne(s),t==="refunds"&&ie(s),t==="expenses"&&te(s),e.jsx("div",{className:"flex justify-end mt-4 space-x-2",children:s.links.map(d=>e.jsx(v,{onClick:()=>F(d.url),variant:d.active?"default":"ghost",dangerouslySetInnerHTML:{__html:d.label}},d.url))})]})]})})]})]})}function ee(l){return e.jsx(u,{children:e.jsxs(D,{children:[e.jsx(N,{children:e.jsxs(a,{children:[e.jsx(r,{children:"Payment Date"}),e.jsx(r,{children:"Member Name"}),e.jsx(r,{children:"Membership Package"}),e.jsx(r,{children:"Bill No."}),e.jsx(r,{children:"Package Amount"}),e.jsx(r,{children:"Extra Discount"}),e.jsx(r,{children:"Net Amount"}),e.jsx(r,{children:"Paid Amount"}),e.jsx(r,{children:"Balance"}),e.jsx(r,{children:"Payment Mode"})]})}),e.jsx(y,{children:l.data.map(s=>{const i=Number(s.net_amount)-Number(s.paid_amount);return e.jsxs(a,{children:[e.jsx(n,{children:R(new Date(s.payment_date),"yyyy-MM-dd")}),e.jsx(n,{children:s.member.name}),e.jsx(n,{children:s.member.membership_package.package_name}),e.jsx(n,{children:e.jsx(o,{className:"text-xs",children:s.bill_number})}),e.jsxs(n,{children:["Rs ",Number(s.total_monthly_fees)+Number(s.admission_fees)-Number(s.package_discount)]}),e.jsxs(n,{children:["Rs ",Number(s.extra_discount)]}),e.jsxs(n,{children:["Rs ",Number(s.net_amount)]}),e.jsxs(n,{children:["Rs ",Number(s.paid_amount)]}),e.jsx(n,{children:i>0?e.jsxs("span",{className:"text-red-500",children:["Rs ",i," ",e.jsx("sub",{children:e.jsx("b",{children:"CR"})})]}):i<0?e.jsxs("span",{className:"text-green-500",children:["Rs ",Math.abs(i)," ",e.jsx("sup",{children:e.jsx("b",{children:"ADV"})})]}):e.jsx("span",{children:"Rs 0"})}),e.jsx(n,{children:s.payment_mode})]},s.id)})})]})})}function se(l){return e.jsx(u,{children:e.jsxs(D,{children:[e.jsx(N,{children:e.jsxs(a,{children:[e.jsx(r,{children:"Payment Date"}),e.jsx(r,{children:"Member Name"}),e.jsx(r,{children:"Locker No."}),e.jsx(r,{children:"Duration"}),e.jsx(r,{children:"Bill Number"}),e.jsx(r,{children:"Locker Charge"}),e.jsx(r,{children:"Locker Discount"}),e.jsx(r,{children:"Net Amount"}),e.jsx(r,{children:"Paid Amount"}),e.jsx(r,{children:"Balance"}),e.jsx(r,{children:"Payment Mode"})]})}),e.jsx(y,{children:l.data.map(s=>{var x;const i=Number(s.net_amount)-Number(s.paid_amount),t=s.total_months===1?"1 Month":`${s.total_months} Months`;return e.jsxs(a,{children:[e.jsx(n,{children:new Date(s.payment_date).toLocaleDateString()}),e.jsx(n,{children:((x=s.member)==null?void 0:x.name)||"Unknown"}),e.jsx(n,{children:e.jsx(o,{variant:"outline",className:"text-primary border-primary",children:e.jsx("strong",{children:s.locker_number})})}),e.jsx(n,{children:t})," ",e.jsx(n,{children:e.jsx(o,{children:s.bill_number})}),e.jsxs(n,{children:["Rs ",Number(s.locker_charge)]}),e.jsxs(n,{children:["Rs ",Number(s.locker_discount)]}),e.jsxs(n,{children:["Rs ",Number(s.net_amount)]}),e.jsxs(n,{children:["Rs ",Number(s.paid_amount)]}),e.jsx(n,{children:i>0?e.jsxs("span",{className:"text-red-500",children:["Rs ",i," ",e.jsx("sub",{children:e.jsx("b",{children:"CR"})})," "]}):i<0?e.jsxs("span",{className:"text-green-500",children:["Rs ",Math.abs(i)," ",e.jsx("sup",{children:e.jsx("b",{children:"ADV"})})," "]}):e.jsx("span",{children:"Rs 0"})}),e.jsx(n,{children:s.payment_mode})," "]},s.id)})})]})})}function re(l){return e.jsx(u,{children:e.jsxs(D,{children:[e.jsx(N,{children:e.jsxs(a,{children:[e.jsx(r,{children:"Payment Date"}),e.jsx(r,{children:"Member Name"}),e.jsx(r,{children:"Membership Package"}),e.jsx(r,{children:"Duration"}),e.jsx(r,{children:"Bill No."}),e.jsx(r,{children:"Package Amount"}),e.jsx(r,{children:"Extra Discount"}),e.jsx(r,{children:"Net Amount"}),e.jsx(r,{children:"Paid Amount"}),e.jsx(r,{children:"Payment Mode"}),e.jsx(r,{children:"Balance"})]})}),e.jsx(y,{children:l.data.map(s=>{const i=Number(s.monthly_fees)*Number(s.total_months)-Number(s.extra_discount)-Number(s.package_discount)-Number(s.paid_amount),t=s.total_months===1?"1 Month":`${s.total_months} Months`;return e.jsxs(a,{children:[e.jsx(n,{children:R(new Date(s.payment_date).toLocaleDateString(),"yyyy-MM-dd")}),e.jsx(n,{children:s.member.name}),e.jsx(n,{children:s.member.membership_package.package_name}),e.jsx(n,{children:t})," ",e.jsx(n,{children:e.jsx(o,{className:"text-xs",children:s.bill_number})}),e.jsxs(n,{children:["Rs ",Number(s.monthly_fees)*Number(s.total_months)-Number(s.package_discount)]}),e.jsxs(n,{children:["Rs ",Number(s.extra_discount)]}),e.jsxs(n,{children:["Rs ",Number(s.net_amount)]}),e.jsxs(n,{children:["Rs ",Number(s.paid_amount)]}),e.jsx(n,{children:s.payment_mode}),e.jsx(n,{children:i>0?e.jsxs("span",{className:"text-red-500",children:["Rs ",i," ",e.jsx("sub",{children:e.jsx("b",{children:"CR"})})]}):i<0?e.jsxs("span",{className:"text-green-500",children:["Rs ",Math.abs(i)," ",e.jsx("sup",{children:e.jsx("b",{children:"ADV"})})]}):e.jsx("span",{children:"Rs 0"})})]},s.id)})})]})})}function ne(l){return e.jsx(u,{children:e.jsxs(D,{children:[e.jsx(N,{children:e.jsxs(a,{children:[e.jsx(r,{children:"Date"}),e.jsx(r,{children:"Name"}),e.jsx(r,{children:"Total"}),e.jsx(r,{children:"Paid"}),e.jsx(r,{children:"Credit"}),e.jsx(r,{children:"Transaction Type"}),e.jsx(r,{children:"Bill No."}),e.jsx(r,{children:"Payment Mode"}),e.jsx(r,{children:"Description"})]})}),e.jsx(y,{children:l.data.map(s=>{var i,t,x;return e.jsxs(a,{children:[e.jsx(n,{children:R(new Date(s.payment_date).toLocaleDateString(),"yyyy-MM-dd")}),e.jsx(n,{children:s.name||((i=s.member)==null?void 0:i.name)}),e.jsxs(n,{children:["Rs ",Number(s.total_amount)]}),e.jsxs(n,{children:["Rs ",Number(s.paid_amount)]}),e.jsxs(n,{children:["Rs ",s.total_amount-s.paid_amount]}),e.jsx(n,{children:s.transaction_type}),e.jsx(n,{children:e.jsx(o,{children:s.bill_number||"N/A"})}),e.jsx(n,{children:s.payment_mode}),e.jsxs(n,{children:[((t=s==null?void 0:s.description)==null?void 0:t.length)>0?s.description.substring(0,50):"",((x=s==null?void 0:s.description)==null?void 0:x.length)>50?"...":""]})]},s.id)})})]})})}function ie(l){return e.jsx(u,{children:e.jsxs(D,{children:[e.jsx(N,{children:e.jsxs(a,{children:[e.jsx(r,{children:"Date"}),e.jsx(r,{children:"Member Name"}),e.jsx(r,{children:"Refund Amount"}),e.jsx(r,{children:"PV No."}),e.jsx(r,{children:"Payment Mode"}),e.jsx(r,{children:"Description"})]})}),e.jsx(y,{children:l.data.map(s=>{var i,t,x;return e.jsxs(a,{children:[e.jsx(n,{children:R(new Date(s.payment_date).toLocaleDateString(),"yyyy-MM-dd")}),e.jsx(n,{children:(i=s.member)==null?void 0:i.name}),e.jsxs(n,{children:["Rs ",Number(s.refund_amount)]}),e.jsx(n,{children:e.jsx(o,{children:s.payment_voucher||"N/A"})}),e.jsx(n,{children:s.payment_mode}),e.jsxs(n,{children:[((t=s==null?void 0:s.description)==null?void 0:t.length)>0?s.description.substring(0,50):"",((x=s==null?void 0:s.description)==null?void 0:x.length)>50?"...":""]})]},s.id)})})]})})}function te(l){return e.jsx(u,{children:e.jsxs(D,{children:[e.jsx(N,{children:e.jsxs(a,{children:[e.jsx(r,{children:"Date"}),e.jsx(r,{children:"Name"}),e.jsx(r,{children:"Expense Amount"}),e.jsx(r,{children:"Expense Type"}),e.jsx(r,{children:"PV No."}),e.jsx(r,{children:"Payment Mode"}),e.jsx(r,{children:"Description"})]})}),e.jsx(y,{children:l.data.map(s=>{var i,t;return e.jsxs(a,{children:[e.jsx(n,{children:R(new Date(s.payment_date).toLocaleDateString(),"yyyy-MM-dd")}),e.jsx(n,{children:s.name}),e.jsxs(n,{children:["Rs ",Number(s.expense_amount)]}),e.jsx(n,{children:s.expense_type}),e.jsx(n,{children:e.jsx(o,{children:s.payment_voucher||"N/A"})}),e.jsx(n,{children:s.payment_mode}),e.jsxs(n,{children:[((i=s==null?void 0:s.description)==null?void 0:i.length)>0?s.description.substring(0,50):"",((t=s==null?void 0:s.description)==null?void 0:t.length)>50?"...":""]})]},s.id)})})]})})}export{Ie as default};
